<p>Les champs marqués d'une astérisque (*) sont obligatoires.</p>
<%- form_for(@convocation) do |f| -%>
  <p>
    <%= f.label(:title, "Titre (*)", :class => "span-1 first") %>
    <span class="span-3">
      <%= f.text_field(:title, :class => "span-2 first") %>
      <%= error_message_on(:convocation, :title, :css_class => "span-2 first") %>
    </span>
  </p>
  <p>
    <%= f.label(:date, "Date (*)", :class => "span-1 first") %>
    <span class="span-3">
      <%= f.datetime_select(:date, :class => "span-2 first", :prompt => true, :start_year => Date.today.year) %>
      <%= error_message_on(:convocation, :date, :css_class => "span-2 first") %>  
    </span>
  </p>
  <p>
    <%= f.label(:place, "Lieu (*)", :class => "span-1 first") %>
    <span class="span-3">
      <%= f.text_field(:place, :class => "span-2 first") %>
      <%= error_message_on(:convocation, :place, :css_class => "span-2 first") %>
    </span>
  </p>  
  <p>
    <%= f.label(:uniform, "Tenue (*)", :class => "span-1 first") %>
    <span class="span-3">
      <%= collection_select(:convocation, :uniform_id, Uniform.all, :id, :title) %>
      <%= error_message_on(:convocation, :uniform, :css_class => "span-2 first") %>
    </span>
  </p>
  <div>
    <%= f.label(:firemen, "Personnel (*)", :class => "span-1 first") %>
    <span class="span-3">
      <table>
        <%- @firemen.group_by(&:status).sort.reverse.each do |status, firemen| -%>
          <tr>
            <td><%= Fireman::STATUS.index(status) %></td>
            <td><%= link_to_function("Cocher/décocher", "$('.status_#{status}').attr('checked',!$('.status_#{status}').attr('checked'));")%></td>
            <td>
              <ul>
                <%= render :partial => "fireman", :collection => firemen, :locals => {:checked => @convocation.firemen, :status => status} %>
              </ul>
            </td>
          </tr>
        <%- end -%>
      </table>
      <%= javascript_tag("
        $('.fireman_id').click(function(){
          var checkbox = $(this).prev(':checkbox');
          checkbox.attr('checked', !checkbox.attr('checked'));
        });
      ")%>
      <%= error_message_on(:convocation, :firemen) %>      
    </span>
  </div>
  <div class="span-3 first prefix-1">
    <%= button_tag(:submit, "Enregistrer") %> ou <%= link_to("Annuler", convocations_path) %>
  </div>
<%- end -%>